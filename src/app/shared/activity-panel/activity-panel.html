<!-- Activity Panel Overlay -->
<div *ngIf="isOpen" class="panel-overlay" (click)="closePanel()">
  <!-- Side Panel -->
  <div class="activity-panel" (click)="$event.stopPropagation()" [@slideIn]>
    <!-- Header -->
    <div class="panel-header">
      <div class="header-content">
        <h2 class="panel-title">Recent Activity</h2>
        <p class="panel-subtitle">Track all recent actions across your projects</p>
      </div>
      <div class="header-actions">
        <button 
          type="button" 
          class="refresh-btn" 
          (click)="refreshActivities()"
          [disabled]="isLoading()"
          title="Refresh activities"
        >
          <svg 
            width="18" 
            height="18" 
            viewBox="0 0 24 24" 
            fill="none" 
            [class.spin]="isLoading()"
          >
            <path 
              d="M21 10C21 10 18.995 7.26822 17.3662 5.63824C15.7373 4.00827 13.4864 3 11 3C6.02944 3 2 7.02944 2 12C2 16.9706 6.02944 21 11 21C15.1031 21 18.5649 18.2543 19.6482 14.5M21 10V4M21 10H15" 
              stroke="currentColor" 
              stroke-width="2" 
              stroke-linecap="round" 
              stroke-linejoin="round"
            />
          </svg>
        </button>
        <button type="button" class="close-btn" (click)="closePanel()" title="Close panel">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading()" class="loading-container">
      <div class="spinner"></div>
      <p class="loading-text">Loading activities...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error() && !isLoading()" class="error-container">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" class="error-icon">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
        <path d="M12 8v4m0 4h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <p class="error-text">{{ error() }}</p>
      <button class="retry-btn" (click)="loadActivities()">Try Again</button>
    </div>

    <!-- Activities List -->
    <div *ngIf="!isLoading() && !error()" class="panel-body">
      <div *ngIf="activities().length === 0" class="empty-state">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" class="empty-icon">
          <path 
            d="M9 5H7C5.89543 5 5 5.89543 5 7V19C5 20.1046 5.89543 21 7 21H17C18.1046 21 19 20.1046 19 19V7C19 5.89543 18.1046 5 17 5H15M9 5C9 6.10457 9.89543 7 11 7H13C14.1046 7 15 6.10457 15 5M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5M12 12H15M12 16H15M9 12H9.01M9 16H9.01" 
            stroke="currentColor" 
            stroke-width="2" 
            stroke-linecap="round"
          />
        </svg>
        <p class="empty-text">No recent activities</p>
        <p class="empty-subtext">Your activity history will appear here</p>
      </div>

      <div class="activities-list" *ngIf="activities().length > 0">
        <div 
          *ngFor="let activity of activities(); let i = index" 
          class="activity-item"
          [style.animation-delay]="i * 0.05 + 's'"
        >
          <!-- Activity Icon/Avatar -->
          <div class="activity-avatar" [ngClass]="getActivityColor(activity.action)">
            <span class="activity-icon">{{ getActivityIcon(activity.entityType) }}</span>
          </div>

          <!-- Activity Content -->
          <div class="activity-content">
            <div class="activity-header">
              <span class="activity-user">{{ activity.userName || 'User' }}</span>
              <span class="activity-time">{{ getTimeAgo(activity.createdAt) }}</span>
            </div>
            
            <p class="activity-description">{{ activity.description }}</p>
            
            <div class="activity-meta">
              <span class="activity-action">{{ activity.action }}</span>
              <span class="activity-separator">â€¢</span>
              <span class="activity-entity">{{ activity.entityType }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
