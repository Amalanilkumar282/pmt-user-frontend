<div class="task-card bg-white rounded-xl p-2 mb-3 cursor-pointer hover:shadow-md transition-all duration-300" 
     [style.border-left]="'3px solid ' + colorClass"
     (click)="open.emit(issue)">
  <div class="content" cdkDragHandle>
    <div class="content-header flex items-start justify-between">
      <!-- Title -->
    <div><h4 class="text-[14px] font-bold text-slate-600 mb-3 leading-snug ">{{ issue.title }}</h4></div>
    
       <!-- Priority Badge (top right) -->
    <div class=" top-3 right-3 text-[10px] px-2.5 rounded-full py-1 rounded font-bold uppercase" [ngClass]="getPriorityPill(issue.priority)">
      {{ issue.priority }}
    </div>
    </div>
    
    <!-- ID -->
    <div class="text-xs font-medium text-slate-500 mb-3">{{ issue.id }}</div>

    <!-- Labels/Tags -->
    <div class="flex flex-wrap gap-2 mb-3 mx-3" *ngIf="issue.labels?.length">
      <span *ngFor="let tag of issue.labels" class="text-xs font-semibold rounded px-2.5 py-1"
            [style.background-color]="getLabelBgColor(tag)"
            [style.color]="getLabelTextColor(tag)">
        {{ tag }}
      </span>
    </div>

    <!-- Description -->
    <p class="text-[13px] text-slate-600 mb-4 line-clamp-2 leading-relaxed" *ngIf="issue.description">
      {{ issue.description }}
    </p>

    <!-- Progress Bar -->
    <div class="mb-4">
      <div class="h-1.5 bg-slate-100 rounded-full overflow-hidden">
        <div class="h-full rounded-full transition-all duration-300" 
             [style.background-color]="colorClass" 
             [style.width.%]="getProgressValue()"></div>
      </div>
    </div>

    <!-- Footer -->
    <div class="flex items-center justify-between text-xs text-slate-500">
      <div class="flex items-center gap-2">
        <div class="w-7 h-7 rounded-full flex items-center justify-center font-bold text-white text-[11px]"
             [ngClass]="issue.assignee | avatarClass"
             [title]="issue.assignee || 'Unassigned'">
          {{ issue.assignee | initials }}
        </div>
      </div>
      
      <div class="flex items-center gap-4">
        <div class="flex items-center gap-1.5" *ngIf="commentsCount > 0">
          <svg class="w-4 h-4 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 2c-2.236 0-4.43.18-6.57.524C1.993 2.755 1 4.014 1 5.426v5.148c0 1.413.993 2.67 2.43 2.902.848.137 1.705.248 2.57.331v3.443a.75.75 0 001.28.53l3.58-3.579a.78.78 0 01.527-.224 41.202 41.202 0 005.183-.5c1.437-.232 2.43-1.49 2.43-2.903V5.426c0-1.413-.993-2.67-2.43-2.902A41.289 41.289 0 0010 2zm0 7a1 1 0 100-2 1 1 0 000 2zM8 8a1 1 0 11-2 0 1 1 0 012 0zm5 1a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
          </svg>
          <span class="text-xs font-medium text-slate-600">{{ commentsCount }}</span>
        </div>
        <div class="flex items-center gap-1.5" *ngIf="dueDate">
          <svg class="w-4 h-4 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M5.75 2a.75.75 0 01.75.75V4h7V2.75a.75.75 0 011.5 0V4h.25A2.75 2.75 0 0118 6.75v8.5A2.75 2.75 0 0115.25 18H4.75A2.75 2.75 0 012 15.25v-8.5A2.75 2.75 0 014.75 4H5V2.75A.75.75 0 015.75 2zm-1 5.5c-.69 0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h10.5c.69 0 1.25-.56 1.25-1.25v-6.5c0-.69-.56-1.25-1.25-1.25H4.75z" clip-rule="evenodd"/>
          </svg>
          <span class="text-xs font-medium text-slate-600">{{ dueDate | date:'MMM d' }}</span>
        </div>
      </div>
    </div>
    
   
  </div>
</div>