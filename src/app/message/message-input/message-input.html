<!-- Message Input -->
<div class="message-input-area">
  <div class="input-wrapper">
    <div class="input-toolbar">
      <button class="toolbar-btn" title="Bold" (click)="applyFormatting('bold')">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M4 2h5a3 3 0 0 1 0 6H4V2z" stroke="currentColor" stroke-width="1.5" />
          <path d="M4 8h6a3 3 0 0 1 0 6H4V8z" stroke="currentColor" stroke-width="1.5" />
        </svg>
      </button>
      <button class="toolbar-btn" title="Italic" (click)="applyFormatting('italic')">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path
            d="M6 2h6M4 14h6M10 2l-4 12"
            stroke="currentColor"
            stroke-width="1.5"
            stroke-linecap="round"
          />
        </svg>
      </button>
      <button class="toolbar-btn" title="Link" (click)="applyFormatting('link')">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path
            d="M7 9l2-2M6 5l-2 2a2.83 2.83 0 0 0 0 4 2.83 2.83 0 0 0 4 0l2-2M10 11l2-2a2.83 2.83 0 0 0 0-4 2.83 2.83 0 0 0-4 0l-2 2"
            stroke="currentColor"
            stroke-width="1.5"
            stroke-linecap="round"
          />
        </svg>
      </button>
      <div class="toolbar-divider"></div>
      <div class="emoji-wrapper">
        <button
          class="toolbar-btn"
          title="Add emoji"
          (click)="toggleEmojiPicker()"
          aria-haspopup="true"
          aria-expanded="false"
        >
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5" />
            <circle cx="6" cy="6.5" r="0.75" fill="currentColor" />
            <circle cx="10" cy="6.5" r="0.75" fill="currentColor" />
            <path
              d="M5.5 9.5C6 10.5 7 11 8 11C9 11 10 10.5 10.5 9.5"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
            />
          </svg>
        </button>

        <div class="emoji-picker" *ngIf="showEmojiPicker()">
          <div class="emoji-grid">
            <button class="emoji-item" type="button" (click)="chooseEmoji('😀')">😀</button>
            <button class="emoji-item" type="button" (click)="chooseEmoji('😊')">😊</button>
            <button class="emoji-item" type="button" (click)="chooseEmoji('👍')">👍</button>
            <button class="emoji-item" type="button" (click)="chooseEmoji('❤️')">❤️</button>
            <button class="emoji-item" type="button" (click)="chooseEmoji('🎉')">🎉</button>
            <button class="emoji-item" type="button" (click)="chooseEmoji('🔥')">🔥</button>
            <button class="emoji-item" type="button" (click)="chooseEmoji('👀')">👀</button>
            <button class="emoji-item" type="button" (click)="chooseEmoji('✅')">✅</button>
          </div>
        </div>
      </div>
    </div>
    <textarea
      #messageTextarea
      class="message-textarea"
      placeholder="Message #{{ channelName() }}"
      [value]="messageText()"
      (input)="messageText.set($any($event.target).value)"
      (keydown)="onKeyDown($event)"
      rows="1"
    ></textarea>
    <button
      class="send-button"
      [disabled]="!messageText().trim()"
      (click)="onSendMessage()"
      title="Send message"
    >
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
        <path d="M2 10L18 2L10 18L9 12L2 10Z" fill="currentColor" />
      </svg>
    </button>
  </div>
</div>
